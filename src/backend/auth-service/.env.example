# Auth Service Environment Configuration
# ==========================================

# Service Configuration
NODE_ENV=development
SERVICE_NAME=auth-service
PORT=3001
API_VERSION=v1
LOG_LEVEL=info
ENABLE_SWAGGER=true

# Database Configuration (PostgreSQL + TypeORM)
DB_HOST=postgres
DB_PORT=5432
DB_NAME=auth_service
DB_USER=auth_user
DB_PASSWORD=your-db-password
DB_SCHEMA=public
DB_SSL_ENABLED=true
DB_POOL_SIZE=20
DB_POOL_IDLE_TIMEOUT=10000
DB_CONNECTION_TIMEOUT=30000
DB_SYNCHRONIZE=false
DB_LOGGING=false

# Redis Configuration (Session & Rate Limiting)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your-redis-password
REDIS_DB=0
REDIS_KEY_PREFIX=auth:
REDIS_RETRY_DELAY=1000
REDIS_MAX_RETRIES=3

# JWT Configuration
JWT_SECRET=your-jwt-secret-here-min-32-characters
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-refresh-secret-here-min-32-characters
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=austa-onboarding
JWT_AUDIENCE=austa-services
JWT_ALGORITHM=HS256

# Security Configuration
BCRYPT_ROUNDS=12
ENCRYPTION_KEY=your-encryption-key-here-32-characters
SESSION_SECRET=your-session-secret-here-min-64-characters
CSRF_TOKEN_SECRET=your-csrf-secret-here-min-32-characters
SECURE_COOKIES=true
COOKIE_MAX_AGE=900000

# MFA Configuration
MFA_ISSUER=AUSTA Onboarding
MFA_WINDOW=1
MFA_ENABLE_SMS=true
MFA_ENABLE_TOTP=true
MFA_CODE_EXPIRY=300

# Twilio Configuration (SMS MFA)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+5511999999999
TWILIO_VERIFY_SERVICE_SID=your-verify-service-sid

# Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
LOGIN_RATE_LIMIT_MAX=5
LOGIN_RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Account Security
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=900000
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_EXPIRY_DAYS=90
PASSWORD_HISTORY_COUNT=5

# CORS Configuration
CORS_ORIGIN=https://*.austa.com.br,http://localhost:3000
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-CSRF-Token
CORS_MAX_AGE=3600

# Session Configuration
SESSION_TIMEOUT=900000
SESSION_REFRESH_THRESHOLD=300000
CONCURRENT_SESSIONS_LIMIT=3

# Role-Based Access Control (RBAC)
DEFAULT_ROLE=beneficiary
ADMIN_EMAIL_DOMAINS=@austa.com.br
REQUIRE_EMAIL_VERIFICATION=true
EMAIL_VERIFICATION_EXPIRY=86400000

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_RETENTION_DAYS=90
LOG_FAILED_LOGINS=true
LOG_SUSPICIOUS_ACTIVITY=true

# GeoIP & Security
ENABLE_GEOIP=true
BLOCK_TOR_EXIT_NODES=true
BLOCK_PROXY=false
ALLOWED_COUNTRIES=BR,US,PT

# Circuit Breaker Configuration
CIRCUIT_BREAKER_TIMEOUT=3000
CIRCUIT_BREAKER_ERROR_THRESHOLD=50
CIRCUIT_BREAKER_VOLUME_THRESHOLD=10
CIRCUIT_BREAKER_RESET_TIMEOUT=30000

# Monitoring & Observability
ENABLE_METRICS=true
PROMETHEUS_PORT=9090
JAEGER_ENDPOINT=http://jaeger:6831
SENTRY_DSN=your-sentry-dsn-here
ENABLE_PROFILING=false

# Health Check Configuration
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/alive

# LGPD Compliance
DATA_RETENTION_DAYS=365
AUDIT_LOG_ENCRYPTION=true
CONSENT_REQUIRED=true
ANONYMIZE_LOGS=true
RIGHT_TO_BE_FORGOTTEN=true

# External Services
NOTIFICATION_SERVICE_URL=http://notification-service:3010
ENROLLMENT_SERVICE_URL=http://enrollment-service:3002
USER_SERVICE_URL=http://user-service:3004

# Feature Flags
ENABLE_MFA_MANDATORY=false
ENABLE_PASSWORD_COMPLEXITY=true
ENABLE_IP_WHITELIST=false
ENABLE_API_KEY_AUTH=false
ENABLE_OAUTH2=false

# OAuth2 Configuration (Future)
OAUTH2_CLIENT_ID=your-oauth2-client-id
OAUTH2_CLIENT_SECRET=your-oauth2-client-secret
OAUTH2_CALLBACK_URL=https://onboarding.austa.com.br/auth/callback
OAUTH2_AUTHORIZATION_URL=https://oauth.provider.com/authorize
OAUTH2_TOKEN_URL=https://oauth.provider.com/token

# Azure Key Vault (Production)
AZURE_KEY_VAULT_URL=your-key-vault-url
AZURE_KEY_VAULT_JWT_SECRET_NAME=jwt-secret
AZURE_KEY_VAULT_ENCRYPTION_KEY_NAME=encryption-key
AZURE_USE_MANAGED_IDENTITY=true

# Backup & Recovery
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
